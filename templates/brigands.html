{% extends "base.html" %}
{% set page_class = "brigands" %}
{% block content %}

<header class="topbar">
  <h1>Gestion des brigands</h1>
</header>

<main class="container">
  <!-- Bloc création -->
  <section class="card">
    <h2>Création d’un brigand</h2>
    <form id="createForm" class="grid">
      <div class="field">
        <label for="name">Nom IG</label>
        <input type="text" id="name" name="name" required placeholder="Ex: Bidule" />
      </div>

      <div class="field">
        <label for="primaryList">Liste principale</label>
        <select id="primaryList" name="list" required>
          <option value="" selected>Aucune</option>
          <option value="surveillance">Liste de surveillance</option>
          <option value="noire">Liste noire</option>
          <option value="hors">Liste noire hors A&C</option>
          <option value="archives">Archives</option>
        </select>
      </div>

      <div class="field span-2">
        <label for="facts">Faits reprochés</label>
        <textarea id="facts" name="facts" rows="3" placeholder="Ex: Prise mairie Lectoure le 08/1471"></textarea>
      </div>

      <div class="field check">
        <label><input type="checkbox" id="isCrown" name="is_crown" /> Recherché par la couronne</label>
      </div>
      <div class="field check">
        <label><input type="checkbox" id="isPNG" name="is_png" /> PNG</label>
      </div>

      <div class="field">
        <label for="orderSelect">Organisation brigande</label>
        <select id="orderSelect" name="order">
          <option value="">Aucun</option>
        </select>
      </div>

      <div class="actions">
        <button type="submit" class="btn brigand">Ajouter</button>
      </div>
    </form>
  </section>

  <!-- Bloc modification/suppression -->
  <section class="card">
    <h2>Modification / Suppression d’un brigand</h2>
    <form id="editSearchForm" class="grid">
      <div class="field" style="max-width: 300px;">
        <label for="editSearch">Nom IG à modifier</label>
        <input type="text" id="editSearch" placeholder="Ex: Bidule" />
      </div>
      <div class="actions" style="max-width: 300px;">
        <button type="button" class="btn brigand">Rechercher</button>
      </div>
    </form>

    <form id="deleteForm" class="grid">
      <div class="field" style="max-width: 300px;">
        <label for="deleteNames">Supprimer brigands (un par ligne)</label>
        <textarea id="deleteNames" rows="4" placeholder="Ex:\nBidule\nMachin\nTrucmuche"></textarea>
      </div>
      <div class="actions" style="max-width: 300px;">
        <button type="submit" class="btn brigand">Supprimer</button>
      </div>
    </form>
  </section>

  <!-- Bloc organisations brigandes -->
  <section class="card">
    <h2>Gérer les organisations brigandes</h2>
    <div class="orders-layout">
      <div class="orders-manage">
        <h4>Ajouter une organisation</h4>
        <form id="orderForm" class="grid">
          <div class="field">
            <label for="orderName">Nom complet</label>
            <input type="text" id="orderName" name="name" required />
          </div>
          <div class="field">
            <label for="orderShort">Nom abrégé</label>
            <input type="text" id="orderShort" name="short" />
          </div>
          <div class="actions">
            <button class="btn brigand" type="submit">Ajouter</button>
          </div>
        </form>
        <div id="ordersTable"></div>
      </div>
    </div>
  </section>

  <!-- Ligne de séparation -->
  <hr style="border: none; border-top: 2px solid #5a3e2b; margin: 2rem 0; width: 60%;">

  <!-- Titre déplacé -->
  <h4>Membres par organisation</h4>
  <div id="ordersMembers"></div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab active" data-tab="principales">Listes principales</button>
    <button class="tab" data-tab="annotatives">Couronne · PNG · Organisations</button>
  </div>

  <!-- Listes principales -->
  <section id="tab-principales" class="tabpane active">
    <section class="card"><h3>Liste noire</h3><div id="table-noire"></div></section>
    <section class="card"><h3>Liste de surveillance</h3><div id="table-surveillance"></div></section>
    <section class="card"><h3>Liste noire hors A&amp;C</h3><div id="table-hors"></div></section>
    <section class="card"><h3>Archives</h3><div id="table-archives"></div></section>
  </section>

  <!-- Listes annotatives -->
  <section id="tab-annotatives" class="tabpane">
    <section class="card"><h3>Recherchés par la couronne</h3><div id="table-couronne"></div></section>
    <section class="card"><h3>PNG</h3><div id="table-png"></div></section>
    <section class="card"><h3>Organisations brigandes</h3><div id="table-orders"></div></section>
  </section>
</main>

<!-- Modal d’édition -->
<div id="modal" class="modal hidden" aria-hidden="true">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Modifier l’entrée</h3>
      <button class="close" id="closeModal" aria-label="Fermer">×</button>
    </div>
    <form id="editForm" class="grid">
      <input type="hidden" id="editId" name="id" />
      <div class="field"><label for="editName">Nom IG</label><input type="text" id="editName" name="name" required /></div>
      <div class="field"><label for="editPrimary">Liste principale</label><select id="editPrimary" name="list" required></select></div>
      <div class="field span-2"><label for="editFacts">Faits reprochés</label><textarea id="editFacts" name="facts" rows="3"></textarea></div>
      <div class="field check"><label><input type="checkbox" id="editCrown" name="is_crown" /> Recherché par la couronne</label></div>
      <div class="field check"><label><input type="checkbox" id="editPNG" name="is_png" /> PNG</label></div>
      <div class="field"><label for="editOrder">Organisation brigande</label><select id="editOrder" name="order" required></select></div>
      <div class="actions">
        <button type="submit" class="btn primary">Valider</button>
        <button type="button" class="btn brigand" id="deleteEntry">Supprimer</button>
        <button type="button" class="btn" id="cancelEdit">Annuler</button>
      </div>
    </form>
  </div>
</div>

<!-- Liens vers les fichiers statiques -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/brigands.css') }}">
<script src="{{ url_for('static', filename='js/app.js') }}"></script>

{% endblock %}
